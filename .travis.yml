language: cpp
sudo: required
dist: trusty
git:
  submodules: true
      
before_install:
  - sudo add-apt-repository --yes ppa:beineri/opt-qt58-trusty
  - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
  - sudo apt-get update -qq
  - sudo apt-get install -qq g++-6 gcc-6
  - sudo aptitude -f install  -y qt58base qt58serialport qt58script qt58svg libusb-dev 
 # - sudo apt-get install -qq -y qt57base qt57declarative qt57imageformats qt57location qt57multimedia qt57quickcontrols qt57script qt57svg qt57tools qt57translations libsdl2-dev
  - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-6 90
  
install:
  - source /opt/qt58/bin/qt58-env.sh
  - # Install QWT
  - # on machines with qt5 executing:  `sudo aptitude -f install libqwt-dev` should be enough
  - svn checkout svn://svn.code.sf.net/p/qwt/code/branches/qwt-6.1 qwt
  - cd qwt
  - cp $TRAVIS_BUILD_DIR/libs/qwt/travis_qwtconfig.pri qwtconfig.pri
  - QWT_ROOT_DIR=`pwd`
  - LD_LIBRARY_PATH=$(readlink -f lib):$LD_LIBRARY_PATH
  - qmake
  - make -j$(nproc)
  - sudo make install
  - CPLUS_INCLUDE_PATH=/usr/local/qwt-svn/include:$CPLUS_INCLUDE_PATH


script:
 # - source /opt/qt58/bin/qt58-env.sh
  - ls 
  - cd $TRAVIS_BUILD_DIR
  - ls
  - qmake
  - make -j$(nproc)
  
#notifications:
#irc:
#    channels:
#      - "chat.freenode.net#phoenix-dev"
#    use_notice: true
#    skip_join: true